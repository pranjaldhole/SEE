\section*{Assignment 3: Statistical Evaluation}
\subsection*{Assignment 2}
\subsubsection*{1. Fix and, if necessary, rerun your experiment according to the feedback in class.}
We were not suggested to re-run the experiment.

\subsubsection*{2. Compare the observed and commanded motions: do they fit? if not, describe possible causes for this.} \update{All readings up to significant digits.}

\begin{figure}[H]
\centering
\includegraphics[width=0.5\textwidth]{exp_setup.png}
\caption{Schematic diagram for specifying conventions.}
\label{schematic-convention}
\end{figure}


Fig. \ref{schematic-convention} defines the signs and conventions used for following calculations. 
\begin{itemize}
	\item O : Origin of world co-ordinate frame
	\item Xr : X-axis of robot co-ordinate frame 
	\item Yr : X-axis of robot co-ordinate frame
	\item $\theta$ : Rotation of Xr around O in CCW direction
	\item (X, Y, $\theta$) :  Initial position and orientation of robot frame in world co-ordinate frame
	\item (X1, Y1, $\theta$1) : Final position and orientation of robot frame after the trail in world co-ordinate frame
\end{itemize}

On real robot, origin of robot co-ordinate frame coincides with the center of axle of the wheels. Xr is perpendicular to the axle and points in the direction of robot's forward motion. \newline

	
\textbf{Commanded Motion Parameters}
\begin{itemize}
	\item commanded speed = 18 cm/sec
	\item time ($t$) = 2250 milliseconds
	\item turn rate ($t_r$) = 40 
	\item distance between wheels (track width $t_w$) = 14.5 cm 
\end{itemize}

\begin{enumerate}
\item \textbf{Straight motion}
\begin{itemize}
\item expected distance to be traveled by by both wheels in x-axis direction = $ 18 * 2.25 = 40.5$ cm
\item expected distance to be traveled by by both wheels in y-axis direction = $0$ cm
\end{itemize}

\textbf{Observed motion}:
mean distance traveled by right wheel in x-direction = 40.5 cm\\
mean distance traveled by left wheel in x-direction = 40.3 cm \\
mean distance traveled by right wheel in y-direction = 0.1 cm \\
mean distance traveled by left wheel in y-direction = 0.1 cm 

	\item \textbf{Right Turn} \\
	\textbf{Parameters set in API}: \newline
	commanded speed = 18 cm/sec \newline
	time = 2250 milliseconds \newline
	\\
	
	Distance of inner wheel from center of rotation ($r_i$) in cm \\ 
	rotational speed of center of the axle of wheels = $\omega$ rad/s \newline
	linear speed of inner wheel ($v_i$) = $r_i * \omega$ cm/s \newline
	linear speed of outer wheel ($v_o$) = $(r_i + t_w ) * \omega$ cm/s \newline
\begin{equation}
\begin{array}{rcl}
\omega &=& \frac{r_i \cdot \frac{t_r}{100}}{t_w} \\
 &=& \frac{18 * 0.4}{14.5} \\
 &=& 0.4966 \text{ rad/sec}
\end{array}
\end{equation}

The radius of the circle is given by,
\begin{equation}
\begin{array}{rcl}
r_i &=& \frac{v_o \cdot \frac{100 - t_r}{100}}{\omega} \\
&=& 21.8 \text{cm}
\end{array}
\end{equation}

The final pose is computed as,
\begin{equation}
\begin{array}{rcl}
x_r &=& 35.5 \text{cm} \\
y_r &=& 5.6 \text{cm} \\
\theta_r &=& \cos^{-1}\left(\frac{2r^2 - s^2}{r^2}\right) = 89.4^{\circ}
\end{array}
\end{equation}

The expected distance travelled by inner wheel $W_i$ is given by,
\begin{equation}
W_{ix} = \sin(\omega \cdot t) \cdot r_i = \sin(0.4966 * 2.25) * 21.75 = 19.6 \text{cm}
\end{equation}

\begin{equation}
W_{iy} = \cos(\omega \cdot t) \cdot r_i - \text{offset} =  \cos(0.4966 * 2.25) * 21.75 - 1.75 = 9.52 - 1.75 = 7.8 \text{ cm}
\end{equation}

The expected distance travelled by outer wheel $W_o$ is given by,
\begin{equation}
W_{ox} = \sin(0.4966 * 2.25) * (21.75 + 14.5) = 32.6 \text{ cm}
\end{equation}

\begin{equation}
W_{oy} = \cos(0.4966 * 2.25) * (21.75 + 14.5) - 1.75 = 15.87 - 1.75 = 13.1 \text{ cm}
\end{equation}

\item \textbf{Left Turn} \\
The final pose is computed as,
\begin{equation}
\begin{array}{rcl}
x_l &=& 35.5 \text{ cm} \\
y_l &=& 105.8 \text{ cm} \\
\theta_l &=& \cos^{-1}\left(\frac{2r^2 - s^2}{r^2}\right) = 89.5^{\circ}
\end{array}
\end{equation}
	
Left turn is mirror motion of right turn, co-ordinates can be obtained by adding translations. 
	
	$$W2x = \sin(0.4966 * 2.25) * 21.75 = 19.6 \text{ cm}$$
	$$W2y = \cos(0.4966 * 2.25) * 21.75 + 42.35 = 9.52 + 42.35 = 51.9 \text{ cm}$$
	
	$$W1x = \sin(0.4966 * 2.25) * (21.75 + 14.5) = 32.58$$
	$$W1y = \cos(0.4966 * 2.25) * (21.75 + 14.5) + 42.35 = 15.87 + 42.35 = 57.2 \text{ cm}$$
	
	
\end{enumerate}

In case of straight line motion, the commanded motion matches with the observed motion. Small random error can be observed in the readings but it can be the result of inaccurate placement of robot before starting the run, inaccurate measurement or LED displacement. 

In case of turning motion, a large error can be observed. The facts for formula derivation for calculation of motion are taken from API provided by lejos library (\href{http://www.lejos.org/nxt/nxj/api/lejos/robotics/navigation/DifferentialPilot.html#steer(double)}{link}\footnote{http://www.lejos.org/nxt/nxj/api/lejos/robotics/navigation/DifferentialPilot.html$\#$steer(double)}). This API documentation does not clarify the effect of turn rate used in \textit{steer} function well enough. The absolute speed value of outer wheel is not clarified. Hence it is assumed to be equal to absolute speed set by DifferentialPilot. This can be the cause of error.
Another reason of error can be the value of track width parsed in the code which is 18.6 cm but it is 14.5 cm on real robot.
If the formula provided in the documentation of lejos API for calculating speed of each wheel set by steer function considers outer wheel's speed equal to absolute speed set by DifferentialPilot function, then the error in track width value must not have any effect on experiment. But clearly, this is not the fact, the assumptions made on turn speed and steer function are needed to be revisited and made cleared with some other sources.      

\newpage
\subsubsection*{3. Fit a Gaussian to your data and judge if the data is truly Gaussian or if it follows another distribution.}

\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{gaussian_fits.png}
\caption{Gaussian fit for the data using scikit-learn KernelDensity function. \update{x labels with units.}}
\label{gaussian}
\end{figure}


\begin{figure}[H]
\centering
\begin{subfigure}[b]{0.3\textwidth}
\includegraphics[width=\textwidth]{right_motion_distribution.png}
\caption{Right turn final pose.}
\label{distribution-right-turn}
\end{subfigure}
\qquad
\begin{subfigure}[b]{0.3\textwidth}
\includegraphics[width=\textwidth]{left_motion_distribution.png}
\caption{Left turn final pose.}
\label{distribution-right-turn}
\end{subfigure}
\qquad
\begin{subfigure}[b]{0.3\textwidth}
\includegraphics[width=\textwidth]{straight_motion_distribution.png}
\caption{Straight motion final pose.}
\label{distribution-straight-motion}
\end{subfigure}
\caption{Gaussian and marginal distributions \update{Final pose distribution.}}
\end{figure}

\newpage
\subsubsection*{4. Compare the estimated uncertainty of the measurement process itself with the statistical uncertainty of the observed end poses.}

\begin{table}[ht]
	\centering
	\begin{tabular}{| l | c | c | c | c | c | c |}
		\hline
		& \multicolumn{2}{c|}{left-turn motion} & \multicolumn{2}{c|}{ right-turn motion} & \multicolumn{2}{c|}{straight motion} \\
		\hline
		& right wheel & left wheel & right wheel & left wheel & right wheel & left wheel \\
		\hline
		Mean linear deviation $(\delta x, \delta y)$ cm & (0.1, 0.9) & (0.6, 0.8)
		& (0.7, 0.9) & (0.2, 0.9) & (0.5, 0.4) & 0.3, 0.4) \\
		\hline
		Mean ang. deviation ($\delta \theta$) degrees & 0.94 & 2.34 & 2.69 & 1.06 & 0.57 & 0.57 \\
		\hline
		$\sigma$ in final pose (x,y) cm & (0.3, 0.3) & (0.3, 0.3) & (0.3, 0.2) & (0.4, 0.5) & (0.2, 0.5) & (0.3, 0.5)\\
		\hline
		uncertainty in pose (x) cm & $(0.1 \pm 0.3)$ & $(0.6 \pm 0.3)$ & $(0.7 \pm 0.3)$ & $(0.2 \pm 0.4)$ & $(0.5 \pm 0.2)$ & $(0.3 \pm 0.3)$ \\
		uncertainty in pose (y) cm & $(0.9 \pm 0.3)$ & $(0.8 \pm 0.3)$ & $(0.9 \pm 0.2)$ & $(0.9 \pm 0.5)$ & $(0.4 \pm 0.5)$ & $(0.2 \pm 0.5)$ \\
		\hline
	\end{tabular}
	\caption{Statistical summary of robot motion}
	\label{stats}
\end{table}
There are three type of uncertainties which we estimated which can occur in the measurement. 
\begin{enumerate}
	\item Uncertainty in initial linear position of robot
	\item Uncertainty in initial angular position of robot
	\item uncertainty in measuring co-ordinates of the wheels
\end{enumerate}   

$1^{st}$ uncertainty will cause small linear error in measurement of wheel position equivalent to error in initial linear position.

$2^{nd}$ uncertainty will cause huge error in measurement of wheel position which will increase with distance traveled by robot. 

$3^{rd}$ uncertainty will cause small error (1 - 2 mm) in linear position of wheels.

\sectionLine
\subsection*{Deliverables 2}
Update your previous weekâ€™s report and add a description of the test for a match with a Gaussian distribution as well as a description of the observed differences between the observed and the computed motion and the actual and expected accuracy and precision. Include appropriate figures, diagrams, and images backing up any claims you make. The report must be self-contained and provide enough details to support any statement you make. If applicable, include a section on problems encountered. Your update should cover:

\subsubsection*{1. Any possible pre-processing of your data, like outlier detection and removal.}
We did not require any outlier detection algorithm since the data collection did not contain any outliers.

\subsubsection*{2. Fit of a Gaussian, either two individual ones in the x and y directions for each of the three cases or a proper two-dimensional distribution per case.}
We were able to fit the Gaussian to the data as shown in fig. \ref{gaussian}.

\subsubsection*{3. Check whether the data are actually distributed according to a Gaussian distribution.}
The data is too limited to conclude whether it comes from Gaussian distribution, however we were able to fit the data to a Gaussian distribution.

\subsubsection*{4. List of used software, including source of any function you wrote for performing your analysis.}
The software code is attached with the report.

\subsubsection*{5. An answer to the following question: When analysing the data with respect to the executed motions, which characteristic of the data do you establish here: the accuracy, the precision, or both?}

Because of the offset in the analytical calculations and actual mean of the readings, we can say that the executed motion was not accurate. But executed motion shows repeatability with lower variance, hence it can be concluded that the motion was precise. We will be revisiting our calculations by clearing the facts related to parameters used in the code, experiment will be re-performed if needed. In conclusion, with current calculations, turning motion was not accurate but it was precise. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%